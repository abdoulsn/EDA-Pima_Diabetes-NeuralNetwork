

```python
# This Python 3 environment
import warnings
import numpy as np # Algebre lineaire 
import pandas as pd # lecture des donnees en CSV file I/O (e.g. pd.read_csv)
import seaborn as sns
import itertools 
import matplotlib.pyplot as plt
plt.style.use('fivethirtyeight')
#plt.style.use('seaborn-white')
#plt.style.use('seaborn')
import lightgbm as lgb
import matplotlib.pyplot as plt
from sklearn.metrics import mean_squared_error
from sklearn.metrics import roc_auc_score, roc_curve
from sklearn.model_selection import StratifiedKFold
warnings.filterwarnings('ignore')
from sklearn.model_selection import train_test_split
```


```python

# +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- #
# On charge les donnees avec pandas.
df = pd.read_csv('pima.csv')
df.info()

df.isnull().sum() # Pas de donnees manquantes

diabetic=df[df['Outcome']==1]  # les personne diabetiques
nondiabetic=df[df['Outcome']==0] # les personnes non diabetics

# Distribution de la variables Outcome dans le base

sns.countplot(x='Outcome',data=df)
plt.show()
df['Outcome'].value_counts(1)  #len(df[df.Outcome == 1])/len(df['Outcome'])
# Nous avons plus de individus sains.
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 768 entries, 0 to 767
    Data columns (total 9 columns):
    Pregnancies                 768 non-null int64
    Glucose                     768 non-null int64
    BloodPressure               768 non-null int64
    SkinThickness               768 non-null int64
    Insulin                     768 non-null int64
    BMI                         768 non-null float64
    DiabetesPedigreeFunction    768 non-null float64
    Age                         768 non-null int64
    Outcome                     768 non-null int64
    dtypes: float64(2), int64(7)
    memory usage: 54.1 KB



![png](output_1_1.png)





    0    0.651042
    1    0.348958
    Name: Outcome, dtype: float64




```python
# Correlation
corr = df.corr()
corr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pregnancies</th>
      <td>1.000000</td>
      <td>0.129459</td>
      <td>0.141282</td>
      <td>-0.081672</td>
      <td>-0.073535</td>
      <td>0.017683</td>
      <td>-0.033523</td>
      <td>0.544341</td>
      <td>0.221898</td>
    </tr>
    <tr>
      <th>Glucose</th>
      <td>0.129459</td>
      <td>1.000000</td>
      <td>0.152590</td>
      <td>0.057328</td>
      <td>0.331357</td>
      <td>0.221071</td>
      <td>0.137337</td>
      <td>0.263514</td>
      <td>0.466581</td>
    </tr>
    <tr>
      <th>BloodPressure</th>
      <td>0.141282</td>
      <td>0.152590</td>
      <td>1.000000</td>
      <td>0.207371</td>
      <td>0.088933</td>
      <td>0.281805</td>
      <td>0.041265</td>
      <td>0.239528</td>
      <td>0.065068</td>
    </tr>
    <tr>
      <th>SkinThickness</th>
      <td>-0.081672</td>
      <td>0.057328</td>
      <td>0.207371</td>
      <td>1.000000</td>
      <td>0.436783</td>
      <td>0.392573</td>
      <td>0.183928</td>
      <td>-0.113970</td>
      <td>0.074752</td>
    </tr>
    <tr>
      <th>Insulin</th>
      <td>-0.073535</td>
      <td>0.331357</td>
      <td>0.088933</td>
      <td>0.436783</td>
      <td>1.000000</td>
      <td>0.197859</td>
      <td>0.185071</td>
      <td>-0.042163</td>
      <td>0.130548</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>0.017683</td>
      <td>0.221071</td>
      <td>0.281805</td>
      <td>0.392573</td>
      <td>0.197859</td>
      <td>1.000000</td>
      <td>0.140647</td>
      <td>0.036242</td>
      <td>0.292695</td>
    </tr>
    <tr>
      <th>DiabetesPedigreeFunction</th>
      <td>-0.033523</td>
      <td>0.137337</td>
      <td>0.041265</td>
      <td>0.183928</td>
      <td>0.185071</td>
      <td>0.140647</td>
      <td>1.000000</td>
      <td>0.033561</td>
      <td>0.173844</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>0.544341</td>
      <td>0.263514</td>
      <td>0.239528</td>
      <td>-0.113970</td>
      <td>-0.042163</td>
      <td>0.036242</td>
      <td>0.033561</td>
      <td>1.000000</td>
      <td>0.238356</td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td>0.221898</td>
      <td>0.466581</td>
      <td>0.065068</td>
      <td>0.074752</td>
      <td>0.130548</td>
      <td>0.292695</td>
      <td>0.173844</td>
      <td>0.238356</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Randomise the data 
from sklearn.utils import shuffle
df = shuffle(df)
# Echantillon de train et  de test
seed = 123
X_train, X_test= train_test_split(df, test_size =0.25, random_state=seed)

app_X  = X_train[X_train.columns[:8]]
test_X = X_test[X_test.columns[:8]]

app_Y  = X_train['Outcome']
test_Y = X_test['Outcome']
```


```python

# +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- #

# 1 ! Neural network

import keras 
import tensorflow as tf
from keras.models import Sequential 
from keras.layers import Dense
from keras.utils.vis_utils import plot_model

# Definisons les callback sur la base de loss pour l'arrete de l'entrainement
class myCallback(tf.keras.callbacks.Callback):
    def on_epoch_end(self, epoch, logs={}):
        if(logs.get('loss') < 0.5):
            print("\n Arret de l'entrainement avec car car loss est inferieur a .3")
            self.model.stop_training = True
          
          
# 2. Définir le modèle
# Les modèles de Keras sont définis comme une séquence de couches. Nous créons un modèle séquentiel et ajoutons des couches  
# une par une jusqu'à ce que notre topologie de réseau nous satisfasse soit 12, 8, 8, 8, 1.  


# create m
m = Sequential()
m.add(Dense(12, input_dim=8, init='uniform', activation='relu'))
m.add(Dense(8, init='uniform', activation='relu'))
m.add(Dense(8, init='uniform', activation='relu'))
m.add(Dense(8, init='uniform', activation='relu'))
m.add(Dense(1, init='uniform', activation='sigmoid'))
m.summary()

# 3. compilation et execution du modele
m.compile(loss='mean_squared_error' , optimizer='adam', metrics=['accuracy'])
callbacks = myCallback()
history = m.fit(app_X, app_Y, epochs=300, batch_size=len(app_X), verbose=1, callbacks=[callbacks])

```

    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    dense_26 (Dense)             (None, 12)                108       
    _________________________________________________________________
    dense_27 (Dense)             (None, 8)                 104       
    _________________________________________________________________
    dense_28 (Dense)             (None, 8)                 72        
    _________________________________________________________________
    dense_29 (Dense)             (None, 8)                 72        
    _________________________________________________________________
    dense_30 (Dense)             (None, 1)                 9         
    =================================================================
    Total params: 365
    Trainable params: 365
    Non-trainable params: 0
    _________________________________________________________________
    Epoch 1/400
    576/576 [==============================] - 0s 865us/step - loss: 0.2500 - acc: 0.3490
    Epoch 2/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2499 - acc: 0.6510
    Epoch 3/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2499 - acc: 0.6510
    Epoch 4/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2498 - acc: 0.6510
    Epoch 5/400
    576/576 [==============================] - 0s 10us/step - loss: 0.2497 - acc: 0.6510
    Epoch 6/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2496 - acc: 0.6510
    Epoch 7/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2495 - acc: 0.6510
    Epoch 8/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2495 - acc: 0.6510
    Epoch 9/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2494 - acc: 0.6510
    Epoch 10/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2493 - acc: 0.6510
    Epoch 11/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2492 - acc: 0.6510
    Epoch 12/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2491 - acc: 0.6510
    Epoch 13/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2490 - acc: 0.6510
    Epoch 14/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2489 - acc: 0.6510
    Epoch 15/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2488 - acc: 0.6510
    Epoch 16/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2487 - acc: 0.6510
    Epoch 17/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2486 - acc: 0.6510
    Epoch 18/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2485 - acc: 0.6510
    Epoch 19/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2484 - acc: 0.6510
    Epoch 20/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2483 - acc: 0.6510
    Epoch 21/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2481 - acc: 0.6510
    Epoch 22/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2480 - acc: 0.6510
    Epoch 23/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2479 - acc: 0.6510
    Epoch 24/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2477 - acc: 0.6510
    Epoch 25/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2475 - acc: 0.6510
    Epoch 26/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2474 - acc: 0.6510
    Epoch 27/400
    576/576 [==============================] - 0s 3us/step - loss: 0.2472 - acc: 0.6510
    Epoch 28/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2470 - acc: 0.6510
    Epoch 29/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2468 - acc: 0.6510
    Epoch 30/400
    576/576 [==============================] - 0s 12us/step - loss: 0.2465 - acc: 0.6510
    Epoch 31/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2463 - acc: 0.6510
    Epoch 32/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2460 - acc: 0.6510
    Epoch 33/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2457 - acc: 0.6510
    Epoch 34/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2454 - acc: 0.6510
    Epoch 35/400
    576/576 [==============================] - 0s 10us/step - loss: 0.2451 - acc: 0.6510
    Epoch 36/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2447 - acc: 0.6510
    Epoch 37/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2443 - acc: 0.6510
    Epoch 38/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2439 - acc: 0.6510
    Epoch 39/400
    576/576 [==============================] - 0s 12us/step - loss: 0.2435 - acc: 0.6510
    Epoch 40/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2430 - acc: 0.6510
    Epoch 41/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2426 - acc: 0.6510
    Epoch 42/400
    576/576 [==============================] - 0s 19us/step - loss: 0.2421 - acc: 0.6510
    Epoch 43/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2416 - acc: 0.6510
    Epoch 44/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2411 - acc: 0.6510
    Epoch 45/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2406 - acc: 0.6510
    Epoch 46/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2401 - acc: 0.6510
    Epoch 47/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2396 - acc: 0.6510
    Epoch 48/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2392 - acc: 0.6510
    Epoch 49/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2389 - acc: 0.6510
    Epoch 50/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2386 - acc: 0.6510
    Epoch 51/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2383 - acc: 0.6510
    Epoch 52/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2381 - acc: 0.6510
    Epoch 53/400
    576/576 [==============================] - 0s 14us/step - loss: 0.2379 - acc: 0.6510
    Epoch 54/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2377 - acc: 0.6510
    Epoch 55/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2375 - acc: 0.6510
    Epoch 56/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2373 - acc: 0.6510
    Epoch 57/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2370 - acc: 0.6510
    Epoch 58/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2367 - acc: 0.6510
    Epoch 59/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2365 - acc: 0.6510
    Epoch 60/400
    576/576 [==============================] - 0s 13us/step - loss: 0.2362 - acc: 0.6510
    Epoch 61/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2360 - acc: 0.6510
    Epoch 62/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2358 - acc: 0.6510
    Epoch 63/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2356 - acc: 0.6510
    Epoch 64/400
    576/576 [==============================] - 0s 14us/step - loss: 0.2353 - acc: 0.6510
    Epoch 65/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2350 - acc: 0.6510
    Epoch 66/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2347 - acc: 0.6510
    Epoch 67/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2344 - acc: 0.6510
    Epoch 68/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2341 - acc: 0.6510
    Epoch 69/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2338 - acc: 0.6510
    Epoch 70/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2334 - acc: 0.6510
    Epoch 71/400
    576/576 [==============================] - 0s 14us/step - loss: 0.2331 - acc: 0.6510
    Epoch 72/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2327 - acc: 0.6510
    Epoch 73/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2323 - acc: 0.6510
    Epoch 74/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2319 - acc: 0.6510
    Epoch 75/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2315 - acc: 0.6510
    Epoch 76/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2311 - acc: 0.6510
    Epoch 77/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2307 - acc: 0.6510
    Epoch 78/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2302 - acc: 0.6510
    Epoch 79/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2298 - acc: 0.6510
    Epoch 80/400
    576/576 [==============================] - 0s 10us/step - loss: 0.2294 - acc: 0.6510
    Epoch 81/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2290 - acc: 0.6510
    Epoch 82/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2286 - acc: 0.6510
    Epoch 83/400
    576/576 [==============================] - 0s 10us/step - loss: 0.2283 - acc: 0.6510
    Epoch 84/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2278 - acc: 0.6510
    Epoch 85/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2274 - acc: 0.6510
    Epoch 86/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2270 - acc: 0.6510
    Epoch 87/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2266 - acc: 0.6510
    Epoch 88/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2261 - acc: 0.6510
    Epoch 89/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2257 - acc: 0.6510
    Epoch 90/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2252 - acc: 0.6510
    Epoch 91/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2248 - acc: 0.6510
    Epoch 92/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2244 - acc: 0.6510
    Epoch 93/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2240 - acc: 0.6528
    Epoch 94/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2235 - acc: 0.6545
    Epoch 95/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2231 - acc: 0.6615
    Epoch 96/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2226 - acc: 0.6701
    Epoch 97/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2221 - acc: 0.6719
    Epoch 98/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2216 - acc: 0.6753
    Epoch 99/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2210 - acc: 0.6823
    Epoch 100/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2204 - acc: 0.6788
    Epoch 101/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2198 - acc: 0.6806
    Epoch 102/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2192 - acc: 0.6840
    Epoch 103/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2185 - acc: 0.6858
    Epoch 104/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2178 - acc: 0.6858
    Epoch 105/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2171 - acc: 0.6858
    Epoch 106/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2165 - acc: 0.6840
    Epoch 107/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2158 - acc: 0.6771
    Epoch 108/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2150 - acc: 0.6753
    Epoch 109/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2143 - acc: 0.6788
    Epoch 110/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2135 - acc: 0.6753
    Epoch 111/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2127 - acc: 0.6771
    Epoch 112/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2119 - acc: 0.6788
    Epoch 113/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2111 - acc: 0.6736
    Epoch 114/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2103 - acc: 0.6771
    Epoch 115/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2095 - acc: 0.6823
    Epoch 116/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2087 - acc: 0.6858
    Epoch 117/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2080 - acc: 0.6840
    Epoch 118/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2072 - acc: 0.6910
    Epoch 119/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2063 - acc: 0.6892
    Epoch 120/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2054 - acc: 0.6910
    Epoch 121/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2047 - acc: 0.6892
    Epoch 122/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2042 - acc: 0.6875
    Epoch 123/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2039 - acc: 0.6771
    Epoch 124/400
    576/576 [==============================] - 0s 7us/step - loss: 0.2036 - acc: 0.6806
    Epoch 125/400
    576/576 [==============================] - 0s 8us/step - loss: 0.2033 - acc: 0.6858
    Epoch 126/400
    576/576 [==============================] - 0s 5us/step - loss: 0.2030 - acc: 0.6823
    Epoch 127/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2026 - acc: 0.6823
    Epoch 128/400
    576/576 [==============================] - 0s 4us/step - loss: 0.2021 - acc: 0.6840
    Epoch 129/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2016 - acc: 0.6875
    Epoch 130/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2012 - acc: 0.6892
    Epoch 131/400
    576/576 [==============================] - 0s 9us/step - loss: 0.2008 - acc: 0.6892
    Epoch 132/400
    576/576 [==============================] - 0s 6us/step - loss: 0.2005 - acc: 0.6927
    Epoch 133/400
    576/576 [==============================] - 0s 12us/step - loss: 0.2002 - acc: 0.6944
    Epoch 134/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1999 - acc: 0.6979
    Epoch 135/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1996 - acc: 0.6944
    Epoch 136/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1992 - acc: 0.6997
    Epoch 137/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1988 - acc: 0.7031
    Epoch 138/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1984 - acc: 0.7049
    Epoch 139/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1981 - acc: 0.7066
    Epoch 140/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1978 - acc: 0.6997
    Epoch 141/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1976 - acc: 0.7014
    Epoch 142/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1974 - acc: 0.6962
    Epoch 143/400
    576/576 [==============================] - 0s 12us/step - loss: 0.1972 - acc: 0.6962
    Epoch 144/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1970 - acc: 0.6979
    Epoch 145/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1968 - acc: 0.6962
    Epoch 146/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1966 - acc: 0.6979
    Epoch 147/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1964 - acc: 0.6979
    Epoch 148/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1962 - acc: 0.6997
    Epoch 149/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1960 - acc: 0.6944
    Epoch 150/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1959 - acc: 0.6927
    Epoch 151/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1957 - acc: 0.6927
    Epoch 152/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1956 - acc: 0.6997
    Epoch 153/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1954 - acc: 0.6997
    Epoch 154/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1952 - acc: 0.6997
    Epoch 155/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1950 - acc: 0.6979
    Epoch 156/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1947 - acc: 0.7014
    Epoch 157/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1945 - acc: 0.6944
    Epoch 158/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1943 - acc: 0.6979
    Epoch 159/400
    576/576 [==============================] - 0s 12us/step - loss: 0.1942 - acc: 0.6979
    Epoch 160/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1941 - acc: 0.6944
    Epoch 161/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1939 - acc: 0.6944
    Epoch 162/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1937 - acc: 0.6979
    Epoch 163/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1935 - acc: 0.6979
    Epoch 164/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1932 - acc: 0.6962
    Epoch 165/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1931 - acc: 0.6927
    Epoch 166/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1929 - acc: 0.6910
    Epoch 167/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1927 - acc: 0.6944
    Epoch 168/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1926 - acc: 0.6962
    Epoch 169/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1924 - acc: 0.6962
    Epoch 170/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1922 - acc: 0.6944
    Epoch 171/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1921 - acc: 0.6944
    Epoch 172/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1919 - acc: 0.6979
    Epoch 173/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1918 - acc: 0.6962
    Epoch 174/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1916 - acc: 0.6997
    Epoch 175/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1914 - acc: 0.6979
    Epoch 176/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1913 - acc: 0.7014
    Epoch 177/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1911 - acc: 0.6997
    Epoch 178/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1910 - acc: 0.7014
    Epoch 179/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1908 - acc: 0.7014
    Epoch 180/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1906 - acc: 0.7014
    Epoch 181/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1905 - acc: 0.7031
    Epoch 182/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1904 - acc: 0.7049
    Epoch 183/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1901 - acc: 0.7049
    Epoch 184/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1900 - acc: 0.7101
    Epoch 185/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1899 - acc: 0.7101
    Epoch 186/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1897 - acc: 0.7083
    Epoch 187/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1895 - acc: 0.7049
    Epoch 188/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1893 - acc: 0.7083
    Epoch 189/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1892 - acc: 0.7083
    Epoch 190/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1890 - acc: 0.7101
    Epoch 191/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1888 - acc: 0.7101
    Epoch 192/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1886 - acc: 0.7101
    Epoch 193/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1885 - acc: 0.7135
    Epoch 194/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1883 - acc: 0.7153
    Epoch 195/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1880 - acc: 0.7135
    Epoch 196/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1878 - acc: 0.7205
    Epoch 197/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1876 - acc: 0.7222
    Epoch 198/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1875 - acc: 0.7205
    Epoch 199/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1873 - acc: 0.7205
    Epoch 200/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1871 - acc: 0.7205
    Epoch 201/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1869 - acc: 0.7274
    Epoch 202/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1867 - acc: 0.7240
    Epoch 203/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1865 - acc: 0.7309
    Epoch 204/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1863 - acc: 0.7292
    Epoch 205/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1862 - acc: 0.7309
    Epoch 206/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1860 - acc: 0.7309
    Epoch 207/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1858 - acc: 0.7292
    Epoch 208/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1855 - acc: 0.7309
    Epoch 209/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1854 - acc: 0.7309
    Epoch 210/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1852 - acc: 0.7292
    Epoch 211/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1850 - acc: 0.7292
    Epoch 212/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1847 - acc: 0.7292
    Epoch 213/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1845 - acc: 0.7292
    Epoch 214/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1844 - acc: 0.7292
    Epoch 215/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1842 - acc: 0.7326
    Epoch 216/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1841 - acc: 0.7309
    Epoch 217/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1838 - acc: 0.7292
    Epoch 218/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1836 - acc: 0.7292
    Epoch 219/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1834 - acc: 0.7274
    Epoch 220/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1833 - acc: 0.7326
    Epoch 221/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1830 - acc: 0.7326
    Epoch 222/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1827 - acc: 0.7361
    Epoch 223/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1826 - acc: 0.7344
    Epoch 224/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1824 - acc: 0.7378
    Epoch 225/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1821 - acc: 0.7309
    Epoch 226/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1819 - acc: 0.7361
    Epoch 227/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1818 - acc: 0.7326
    Epoch 228/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1814 - acc: 0.7326
    Epoch 229/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1811 - acc: 0.7361
    Epoch 230/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1810 - acc: 0.7361
    Epoch 231/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1808 - acc: 0.7361
    Epoch 232/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1806 - acc: 0.7396
    Epoch 233/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1804 - acc: 0.7378
    Epoch 234/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1802 - acc: 0.7326
    Epoch 235/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1800 - acc: 0.7344
    Epoch 236/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1798 - acc: 0.7344
    Epoch 237/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1797 - acc: 0.7431
    Epoch 238/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1796 - acc: 0.7431
    Epoch 239/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1793 - acc: 0.7396
    Epoch 240/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1791 - acc: 0.7396
    Epoch 241/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1790 - acc: 0.7378
    Epoch 242/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1788 - acc: 0.7396
    Epoch 243/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1785 - acc: 0.7413
    Epoch 244/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1783 - acc: 0.7431
    Epoch 245/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1782 - acc: 0.7431
    Epoch 246/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1779 - acc: 0.7483
    Epoch 247/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1777 - acc: 0.7431
    Epoch 248/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1776 - acc: 0.7413
    Epoch 249/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1774 - acc: 0.7465
    Epoch 250/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1772 - acc: 0.7465
    Epoch 251/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1771 - acc: 0.7483
    Epoch 252/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1768 - acc: 0.7500
    Epoch 253/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1765 - acc: 0.7465
    Epoch 254/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1763 - acc: 0.7483
    Epoch 255/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1762 - acc: 0.7448
    Epoch 256/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1762 - acc: 0.7448
    Epoch 257/400
    576/576 [==============================] - 0s 14us/step - loss: 0.1761 - acc: 0.7483
    Epoch 258/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1758 - acc: 0.7465
    Epoch 259/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1754 - acc: 0.7500
    Epoch 260/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1752 - acc: 0.7483
    Epoch 261/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1753 - acc: 0.7448
    Epoch 262/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1751 - acc: 0.7500
    Epoch 263/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1747 - acc: 0.7483
    Epoch 264/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1746 - acc: 0.7483
    Epoch 265/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1745 - acc: 0.7500
    Epoch 266/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1742 - acc: 0.7465
    Epoch 267/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1739 - acc: 0.7465
    Epoch 268/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1740 - acc: 0.7500
    Epoch 269/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1738 - acc: 0.7483
    Epoch 270/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1734 - acc: 0.7517
    Epoch 271/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1734 - acc: 0.7535
    Epoch 272/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1732 - acc: 0.7465
    Epoch 273/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1728 - acc: 0.7483
    Epoch 274/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1728 - acc: 0.7465
    Epoch 275/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1727 - acc: 0.7431
    Epoch 276/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1723 - acc: 0.7517
    Epoch 277/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1722 - acc: 0.7535
    Epoch 278/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1720 - acc: 0.7500
    Epoch 279/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1717 - acc: 0.7517
    Epoch 280/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1715 - acc: 0.7500
    Epoch 281/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1714 - acc: 0.7500
    Epoch 282/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1711 - acc: 0.7517
    Epoch 283/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1710 - acc: 0.7569
    Epoch 284/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1708 - acc: 0.7587
    Epoch 285/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1706 - acc: 0.7517
    Epoch 286/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1703 - acc: 0.7535
    Epoch 287/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1702 - acc: 0.7500
    Epoch 288/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1700 - acc: 0.7535
    Epoch 289/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1697 - acc: 0.7587
    Epoch 290/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1696 - acc: 0.7604
    Epoch 291/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1694 - acc: 0.7552
    Epoch 292/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1691 - acc: 0.7587
    Epoch 293/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1689 - acc: 0.7604
    Epoch 294/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1687 - acc: 0.7500
    Epoch 295/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1686 - acc: 0.7587
    Epoch 296/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1683 - acc: 0.7604
    Epoch 297/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1681 - acc: 0.7569
    Epoch 298/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1679 - acc: 0.7587
    Epoch 299/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1677 - acc: 0.7569
    Epoch 300/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1676 - acc: 0.7604
    Epoch 301/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1674 - acc: 0.7552
    Epoch 302/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1671 - acc: 0.7604
    Epoch 303/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1668 - acc: 0.7569
    Epoch 304/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1666 - acc: 0.7552
    Epoch 305/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1665 - acc: 0.7622
    Epoch 306/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1663 - acc: 0.7569
    Epoch 307/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1660 - acc: 0.7604
    Epoch 308/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1657 - acc: 0.7535
    Epoch 309/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1655 - acc: 0.7552
    Epoch 310/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1654 - acc: 0.7604
    Epoch 311/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1653 - acc: 0.7535
    Epoch 312/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1652 - acc: 0.7656
    Epoch 313/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1648 - acc: 0.7587
    Epoch 314/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1644 - acc: 0.7604
    Epoch 315/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1641 - acc: 0.7587
    Epoch 316/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1639 - acc: 0.7569
    Epoch 317/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1639 - acc: 0.7639
    Epoch 318/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1636 - acc: 0.7587
    Epoch 319/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1632 - acc: 0.7674
    Epoch 320/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1629 - acc: 0.7587
    Epoch 321/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1627 - acc: 0.7569
    Epoch 322/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1626 - acc: 0.7656
    Epoch 323/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1624 - acc: 0.7587
    Epoch 324/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1621 - acc: 0.7656
    Epoch 325/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1617 - acc: 0.7587
    Epoch 326/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1614 - acc: 0.7656
    Epoch 327/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1612 - acc: 0.7691
    Epoch 328/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1611 - acc: 0.7569
    Epoch 329/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1609 - acc: 0.7726
    Epoch 330/400
    576/576 [==============================] - 0s 10us/step - loss: 0.1606 - acc: 0.7604
    Epoch 331/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1604 - acc: 0.7691
    Epoch 332/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1600 - acc: 0.7604
    Epoch 333/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1597 - acc: 0.7656
    Epoch 334/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1594 - acc: 0.7587
    Epoch 335/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1592 - acc: 0.7622
    Epoch 336/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1590 - acc: 0.7691
    Epoch 337/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1588 - acc: 0.7622
    Epoch 338/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1589 - acc: 0.7691
    Epoch 339/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1589 - acc: 0.7691
    Epoch 340/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1587 - acc: 0.7674
    Epoch 341/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1580 - acc: 0.7639
    Epoch 342/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1574 - acc: 0.7708
    Epoch 343/400
    576/576 [==============================] - 0s 11us/step - loss: 0.1572 - acc: 0.7743
    Epoch 344/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1573 - acc: 0.7639
    Epoch 345/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1572 - acc: 0.7760
    Epoch 346/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1567 - acc: 0.7622
    Epoch 347/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1562 - acc: 0.7691
    Epoch 348/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1561 - acc: 0.7760
    Epoch 349/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1562 - acc: 0.7674
    Epoch 350/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1560 - acc: 0.7795
    Epoch 351/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1556 - acc: 0.7656
    Epoch 352/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1551 - acc: 0.7708
    Epoch 353/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1549 - acc: 0.7726
    Epoch 354/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1550 - acc: 0.7656
    Epoch 355/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1549 - acc: 0.7830
    Epoch 356/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1545 - acc: 0.7674
    Epoch 357/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1540 - acc: 0.7708
    Epoch 358/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1539 - acc: 0.7708
    Epoch 359/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1539 - acc: 0.7691
    Epoch 360/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1537 - acc: 0.7778
    Epoch 361/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1533 - acc: 0.7743
    Epoch 362/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1530 - acc: 0.7726
    Epoch 363/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1528 - acc: 0.7726
    Epoch 364/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1526 - acc: 0.7743
    Epoch 365/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1525 - acc: 0.7726
    Epoch 366/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1524 - acc: 0.7743
    Epoch 367/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1522 - acc: 0.7760
    Epoch 368/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1520 - acc: 0.7726
    Epoch 369/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1517 - acc: 0.7760
    Epoch 370/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1514 - acc: 0.7743
    Epoch 371/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1512 - acc: 0.7760
    Epoch 372/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1510 - acc: 0.7743
    Epoch 373/400
    576/576 [==============================] - 0s 15us/step - loss: 0.1509 - acc: 0.7726
    Epoch 374/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1509 - acc: 0.7830
    Epoch 375/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1509 - acc: 0.7691
    Epoch 376/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1510 - acc: 0.7865
    Epoch 377/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1510 - acc: 0.7726
    Epoch 378/400
    576/576 [==============================] - 0s 4us/step - loss: 0.1509 - acc: 0.7865
    Epoch 379/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1500 - acc: 0.7708
    Epoch 380/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1496 - acc: 0.7726
    Epoch 381/400
    576/576 [==============================] - 0s 9us/step - loss: 0.1497 - acc: 0.7812
    Epoch 382/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1499 - acc: 0.7708
    Epoch 383/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1496 - acc: 0.7917
    Epoch 384/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1490 - acc: 0.7760
    Epoch 385/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1487 - acc: 0.7726
    Epoch 386/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1489 - acc: 0.7882
    Epoch 387/400
    576/576 [==============================] - 0s 8us/step - loss: 0.1489 - acc: 0.7743
    Epoch 388/400
    576/576 [==============================] - 0s 12us/step - loss: 0.1487 - acc: 0.7882
    Epoch 389/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1481 - acc: 0.7726
    Epoch 390/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1476 - acc: 0.7847
    Epoch 391/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1475 - acc: 0.7847
    Epoch 392/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1476 - acc: 0.7778
    Epoch 393/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1476 - acc: 0.7882
    Epoch 394/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1473 - acc: 0.7778
    Epoch 395/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1468 - acc: 0.7882
    Epoch 396/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1464 - acc: 0.7847
    Epoch 397/400
    576/576 [==============================] - 0s 5us/step - loss: 0.1462 - acc: 0.7882
    Epoch 398/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1460 - acc: 0.7830
    Epoch 399/400
    576/576 [==============================] - 0s 6us/step - loss: 0.1461 - acc: 0.7795
    Epoch 400/400
    576/576 [==============================] - 0s 7us/step - loss: 0.1461 - acc: 0.7917



```python
# le courbe de l'accuracy
plt.plot(history.history['acc'])
plt.show()
```


![png](output_5_0.png)



```python
# Evaluation du modele
scores = m.evaluate(test_X, test_Y)
print("\n%s: %.2f%%" % (m.metrics_names[1], scores[1]*100))
```

    192/192 [==============================] - 0s 47us/step
    
    acc: 76.56%

